{% extends "base.html" %}

{% block title %}Home{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}

{% block content %}
<!-- Scroll Progress Bar -->
<div class="scroll-progress"></div>

<!-- Loading Overlay -->
<div class="loading-overlay">
    <div class="loader"></div>
</div>

<!-- Particle Background -->
<div id="particles-js"></div>

<!-- Floating Shapes -->
<div class="floating-shapes">
    <svg class="shape" width="50" height="50" viewBox="0 0 50 50">
        <rect width="50" height="50" fill="white"/>
    </svg>
    <svg class="shape" width="50" height="50" viewBox="0 0 50 50">
        <circle cx="25" cy="25" r="20" fill="white"/>
    </svg>
    <svg class="shape" width="50" height="50" viewBox="0 0 50 50">
        <polygon points="25,5 45,45 5,45" fill="white"/>
    </svg>
    <svg class="shape" width="50" height="50" viewBox="0 0 50 50">
        <path d="M25,5 L45,25 L25,45 L5,25 Z" fill="white"/>
    </svg>
</div>

<!-- Dark Mode Toggle -->
<button class="theme-toggle" id="themeToggle" aria-label="Toggle Dark Mode">
    <i class="fas fa-moon"></i>
</button>

<div class="container px-4 py-5">
    <div class="company-header text-center mb-5 animate__animated animate__fadeIn">
        <h1>Building Estimate</h1>
        <p>Professional Construction Calculator</p>
    </div>

    <!-- Active Calculators Section -->
    <div class="active-calculators mb-5">
        <h2 class="section-title text-light mb-4 animate__animated animate__fadeIn">Active Calculators</h2>
        <div class="row g-4 py-5 row-cols-1 row-cols-lg-3">
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="pile">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>Pile Estimate</h3>
                    <p>Calculate material quantities and costs for pile foundations with our comprehensive pile estimate calculator.</p>
                    <a href="{{ url_for('pile_estimate') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="long-tied">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-columns"></i>
                    </div>
                    <h3>Long Tied Column</h3>
                    <p>Estimate materials and costs for long tied columns with our specialized calculator.</p>
                    <a href="{{ url_for('long_tied_column') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="long-circular">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-circle"></i>
                    </div>
                    <h3>Long Circular Column</h3>
                    <p>Calculate quantities and costs for long circular columns with precision and ease.</p>
                    <a href="{{ url_for('long_circular_column') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="slab">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-th"></i>
                    </div>
                    <h3>Slab Estimate</h3>
                    <p>Get accurate material estimates and costs for concrete slabs with our dedicated calculator.</p>
                    <a href="{{ url_for('slab_estimate') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="short-tied">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-columns"></i>
                    </div>
                    <h3>Short Tied Column</h3>
                    <p>Calculate material quantities and costs for short tied columns with precision.</p>
                    <a href="{{ url_for('short_tied_column') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100" data-calculator="short-circular">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-circle"></i>
                    </div>
                    <h3>Short Circular Column</h3>
                    <p>Calculate material quantities and costs for short circular columns with precision.</p>
                    <a href="{{ url_for('short_circular_column') }}" class="btn btn-primary btn-ripple">
                        Open Calculator
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Coming Soon Section -->
    <div class="coming-soon mt-5">
        <h2 class="section-title text-light mb-4 animate__animated animate__fadeIn" style="animation-delay: 0.5s">Coming Soon</h2>
        <div class="row g-4 py-3 row-cols-1 row-cols-lg-3">
            <div class="feature col">
                <div class="feature-card h-100 disabled">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-wall"></i>
                    </div>
                    <h3>Wall Estimate</h3>
                    <p>Coming soon: Calculate material quantities and costs for wall construction.</p>
                    <button class="btn btn-secondary" disabled>Coming Soon</button>
                </div>
            </div>
            <div class="feature col">
                <div class="feature-card h-100 disabled">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-stairs"></i>
                    </div>
                    <h3>Stair Estimate</h3>
                    <p>Coming soon: Estimate materials and costs for staircase construction.</p>
                    <button class="btn btn-secondary" disabled>Coming Soon</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const icon = themeToggle.querySelector('i');
        
        // Check for saved theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.documentElement.setAttribute('data-theme', savedTheme);
            icon.className = savedTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }
        
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            icon.className = newTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        });

        // Remove loading overlay if it's active when page loads
        const loadingOverlay = document.querySelector('.loading-overlay');
        if (loadingOverlay) {
            loadingOverlay.classList.remove('active');
        }

        // Initialize particles with enhanced configuration
        particlesJS('particles-js', {
            particles: {
                number: { value: 80, density: { enable: true, value_area: 800 } },
                color: { value: '#ffffff' },
                shape: { type: 'circle' },
                opacity: { value: 0.1, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: '#ffffff', opacity: 0.1, width: 1 },
                move: { enable: true, speed: 2, direction: 'none', random: true, straight: false, out_mode: 'out' }
            },
            interactivity: {
                detect_on: 'canvas',
                events: {
                    onhover: { enable: true, mode: 'repulse' },
                    onclick: { enable: true, mode: 'push' },
                    resize: true
                }
            },
            retina_detect: true
        });

        // Enhanced card hover effect
        document.querySelectorAll('.feature-card').forEach(card => {
            card.addEventListener('mousemove', e => {
                const rect = card.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / card.clientWidth) * 100;
                const y = ((e.clientY - rect.top) / card.clientHeight) * 100;
                
                card.style.setProperty('--mouse-x', `${x}%`);
                card.style.setProperty('--mouse-y', `${y}%`);
                
                // Add dynamic glow effect based on calculator type
                const calculatorType = card.getAttribute('data-calculator');
                if (calculatorType) {
                    const color = getComputedStyle(card).getPropertyValue('--calculator-color');
                    card.style.boxShadow = `0 20px 40px var(--glass-shadow),
                                          0 0 20px ${color}`;
                }
            });
            
            card.addEventListener('mouseleave', () => {
                card.style.boxShadow = '0 20px 40px var(--glass-shadow), 0 0 20px var(--glow-color)';
            });
        });

        // Ripple effect for buttons
        document.querySelectorAll('.btn-ripple').forEach(button => {
            button.addEventListener('click', e => {
                const rect = button.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                const ripple = document.createElement('span');
                ripple.className = 'ripple';
                ripple.style.left = `${x}px`;
                ripple.style.top = `${y}px`;
                
                button.appendChild(ripple);
                setTimeout(() => ripple.remove(), 600);
            });
        });

        // Loading animation
        document.querySelectorAll('a[href]').forEach(link => {
            link.addEventListener('click', e => {
                if (link.href.includes('calculate')) {
                    const overlay = document.querySelector('.loading-overlay');
                    overlay.classList.add('active');
                    
                    setTimeout(() => {
                        overlay.classList.remove('active');
                    }, 5000);
                }
            });
        });

        // Handle browser back/forward buttons
        window.addEventListener('pageshow', (event) => {
            const overlay = document.querySelector('.loading-overlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        });

        // Enhanced scroll progress
        const progressBar = document.querySelector('.scroll-progress');
        window.addEventListener('scroll', () => {
            const winScroll = document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            progressBar.style.transform = `scaleX(${scrolled / 100})`;
        });

        // Intersection Observer for scroll animations
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate__fadeInUp');
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.feature-card').forEach(card => {
            observer.observe(card);
        });
    });
</script>
{% endblock %}
